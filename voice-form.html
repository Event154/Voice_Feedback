<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Record Your Voice</title>
</head>
<body>

<h2>Record Your Voice</h2>
<button id="recordButton">Start / Stop</button>
<p id="status">Press the button to start recording</p>

<script>
let mediaRecorder;
let audioChunks = [];
let isRecording = false; // Ù„ØªØªØ­ÙˆÙ‘Ù„ Ù…Ù† start Ø¥Ù„Ù‰ stop Ø¨ÙƒØ¨Ø³Ø© ÙˆØ­Ø¯Ù‡

const button = document.querySelector('#recordButton');
const audioPreview = document.querySelector('#audioPreview');

button.addEventListener('click', async () => {
    if (!isRecording) {
        // Start Recording
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        mediaRecorder = new MediaRecorder(stream);
        audioChunks = [];
        mediaRecorder.start();

        mediaRecorder.addEventListener("dataavailable", event => {
            audioChunks.push(event.data);
        });

        button.textContent = "â¹ Stop Recording";  
        isRecording = true;  // ØµØ§Ø± Ø§Ù„ÙˆØ¶Ø¹ Recording
    } else {
        // Stop Recording & Send to Backend
        mediaRecorder.stop();
        mediaRecorder.addEventListener("stop", async () => {
            const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
            const formData = new FormData();
            formData.append("audio", audioBlob, "recording.wav");

            // ğŸ”¥ API URL ØªØ¨Ø¹Ùƒ ÙŠÙ„ÙŠ Ù…Ù† Render
            const url = "https://voice-feedback-api.onrender.com/upload-audio";

            try {
                const response = await fetch(url, {
                    method: "POST",
                    body: formData
                });

                if (response.ok) {
                    alert("ğŸ‰ Audio uploaded successfully!");
                } else {
                    alert("âŒ Upload failed!");
                }

            } catch (error) {
                console.error(error);
                alert("âš ï¸ Error uploading audio!");
            }

        });

        button.textContent = "ğŸ¤ Start Recording"; 
        isRecording = false; // Ø±Ø¬Ø¹ Ø¬Ø§Ù‡Ø² Ù„ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
    }
});
</script>


</body>
</html>

